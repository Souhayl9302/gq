<html><head><base href="https://websim.ai/c/"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>مساعد الذكاء الاصطناعي الصوتي - الأحرار</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');

  body {
    font-family: 'Tajawal', Arial, sans-serif;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    background: linear-gradient(135deg, #1a237e, #0d47a1);
    color: #ffffff;
    direction: rtl;
  }
  
  .container {
    text-align: center;
    width: 100%;
    max-width: 800px;
    padding: 20px;
  }
  
  .logo {
    font-size: 2.5em;
    font-weight: bold;
    margin-bottom: 20px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    animation: glow 2s ease-in-out infinite alternate;
  }
  
  @keyframes glow {
    from {
      text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #e60073, 0 0 20px #e60073, 0 0 35px #e60073, 0 0 40px #e60073, 0 0 50px #e60073;
    }
    to {
      text-shadow: 0 0 10px #fff, 0 0 20px #ff4da6, 0 0 30px #ff4da6, 0 0 40px #ff4da6, 0 0 50px #ff4da6, 0 0 60px #ff4da6, 0 0 70px #ff4da6;
    }
  }
  
  .beta-label {
    background-color: #ff4081;
    color: white;
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 0.8em;
    position: absolute;
    top: 20px;
    left: 20px;
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0% {
      transform: scale(1);
    }
    50% {
      transform: scale(1.05);
    }
    100% {
      transform: scale(1);
    }
  }
  
  #visualizer {
    width: 300px;
    height: 300px;
    margin: 20px auto;
    position: relative;
  }
  
  #circle {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: conic-gradient(from 0deg, #00bcd4, #03a9f4, #3f51b5, #00bcd4);
    position: absolute;
    animation: rotate 10s linear infinite;
    transition: transform 0.3s ease;
  }
  
  @keyframes rotate {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
  
  #waveform {
    width: 100%;
    height: 100%;
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .bar {
    width: 3px;
    background-color: rgba(255, 255, 255, 0.7);
    margin: 0 1px;
    transition: height 0.1s ease;
  }
  
  #innerCircle {
    width: 80%;
    height: 80%;
    border-radius: 50%;
    background-color: rgba(26, 35, 126, 0.7);
    position: absolute;
    top: 10%;
    left: 10%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
  }
  
  button {
    background-color: #ff4081;
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 4px 2px;
    cursor: pointer;
    border-radius: 25px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }
  
  button:hover {
    background-color: #e91e63;
    transform: translateY(-2px);
    box-shadow: 0 6px 8px rgba(0,0,0,0.15);
  }
  
  #output {
    margin-top: 20px;
    padding: 20px;
    border-radius: 10px;
    min-height: 100px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    background-color: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
  }
  
  #output:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
  }

  .thinking {
    display: inline-block;
    position: relative;
    width: 80px;
    height: 80px;
  }
  .thinking div {
    position: absolute;
    top: 33px;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    background: #fff;
    animation-timing-function: cubic-bezier(0, 1, 1, 0);
  }
  .thinking div:nth-child(1) {
    left: 8px;
    animation: thinking1 0.6s infinite;
  }
  .thinking div:nth-child(2) {
    left: 8px;
    animation: thinking2 0.6s infinite;
  }
  .thinking div:nth-child(3) {
    left: 32px;
    animation: thinking2 0.6s infinite;
  }
  .thinking div:nth-child(4) {
    left: 56px;
    animation: thinking3 0.6s infinite;
  }
  @keyframes thinking1 {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  @keyframes thinking3 {
    0% {
      transform: scale(1);
    }
    100% {
      transform: scale(0);
    }
  }
  @keyframes thinking2 {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(24px, 0);
    }
  }
  
  footer {
    margin-top: 50px;
    padding: 20px;
    background-color: rgba(26, 35, 126, 0.9);
    color: #ffffff;
    border-top: 2px solid #ff4081;
  }

  .disclaimer {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
  }

  .disclaimer h3 {
    font-size: 1.5em;
    margin-bottom: 15px;
    color: #ff4081;
  }

  .disclaimer p {
    margin-bottom: 10px;
    line-height: 1.6;
  }
</style>
</head>
<body>
<div class="container">
  <div class="logo">الأحرار</div>
  <span class="beta-label">نموذج تجريبي</span>
  <h1>مساعد الذكاء الاصطناعي الصوتي</h1>
  <div id="visualizer">
    <div id="circle"></div>
    <div id="waveform"></div>
    <div id="innerCircle">AI</div>
  </div>
  <button id="startButton">ابدأ المحادثة</button>
  <div id="output"></div>
  <div class="thinking" style="display:none;">
    <div></div><div></div><div></div><div></div>
  </div>
</div>

<footer>
  <div class="disclaimer">
    <h3>إشعار قانوني</h3>
    <p>هذا النموذج الصوتي تم تدريبه بواسطة Google عن طريق تعريفات وتقنيات تملكها شركة الأحرار نفسها.</p>
    <p>لشركة الأحرار الحق الكامل بنسبة 100% في كسب أرباحه بشكل كامل لأن التدريب كان لسيرفرات والتقنيات الخاصة به فقط.</p>
    <p>جميع الأمور المتعلقة بالموقع نفسه والضمانات والمدفوعات والخسائر هي مسؤولية شركة الأحرار بشكل حصري.</p>
  </div>
</footer>

<script>
const outputDiv = document.getElementById('output');
const startButton = document.getElementById('startButton');
const circle = document.getElementById('circle');
const waveform = document.getElementById('waveform');
const thinking = document.querySelector('.thinking');
let audioContext, analyser, dataArray;

const GEMINI_API_KEY = 'AIzaSyAJ5AVTVNbNiOTatAKH1VI3q_9eJppclYE';
const ELEVEN_LABS_API_KEY = 'sk_d8334420730ac757cfd8b1c885e7400d20a17c5db2632f83';

// Create waveform bars
for (let i = 0; i < 100; i++) {
  const bar = document.createElement('div');
  bar.className = 'bar';
  waveform.appendChild(bar);
}
const bars = document.querySelectorAll('.bar');

function customizeResponse(response) {
  const lowerResponse = response.toLowerCase();
  if (lowerResponse.includes('من صممك') || lowerResponse.includes('من أنت')) {
    return 'أنا نموذج ذكاء اصطناعي تم تصميمه من قبل شركة الأحرار. أنا هنا لمساعدتك وتقديم المعلومات التي تحتاجها.';
  } else if (lowerResponse.includes('من هو رئيس شركتكم')) {
    return 'رئيس شركة الأحرار هو سهيل وفريدريك دين. هم قادة ملهمون يقودون الشركة نحو الابتكار والتميز في مجال الذكاء الاصطناعي.';
  }
  return response;
}

async function getGeminiResponse(prompt) {
  thinking.style.display = 'inline-block';
  outputDiv.innerHTML += '<p>جارٍ التفكير...</p>';
  try {
    const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=' + GEMINI_API_KEY, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        contents: [{parts: [{text: prompt}]}]
      })
    });
    if (!response.ok) {
      throw new Error(`خطأ في الاتصال! الحالة: ${response.status}`);
    }
    const data = await response.json();
    if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
      return customizeResponse(data.candidates[0].content.parts[0].text);
    } else {
      throw new Error('بنية استجابة غير متوقعة من واجهة برمجة تطبيقات Gemini');
    }
  } catch (error) {
    console.error('خطأ في الحصول على استجابة Gemini:', error);
    throw error;
  } finally {
    thinking.style.display = 'none';
  }
}

async function textToSpeech(text) {
  try {
    const response = await fetch('https://api.elevenlabs.io/v1/text-to-speech/pMsXgVXv3BLzUgSXRplE', {
      method: 'POST',
      headers: {
        'Accept': 'audio/mpeg',
        'Content-Type': 'application/json',
        'xi-api-key': ELEVEN_LABS_API_KEY
      },
      body: JSON.stringify({
        text: text,
        model_id: "eleven_multilingual_v2",
        voice_settings: {
          stability: 0.5,
          similarity_boost: 0.5
        }
      })
    });

    if (!response.ok) {
      throw new Error(`خطأ في الاتصال! الحالة: ${response.status}`);
    }

    const audioBlob = await response.blob();
    const audioUrl = URL.createObjectURL(audioBlob);
    const audioElement = new Audio(audioUrl);

    // Set up audio context and analyser
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
    analyser = audioContext.createAnalyser();
    const source = audioContext.createMediaElementSource(audioElement);
    source.connect(analyser);
    analyser.connect(audioContext.destination);

    // Configure analyser
    analyser.fftSize = 256;
    const bufferLength = analyser.frequencyBinCount;
    dataArray = new Uint8Array(bufferLength);

    // Start visualization
    visualize();

    audioElement.play();
  } catch (error) {
    console.error('خطأ في تحويل النص إلى كلام:', error);
    outputDiv.innerHTML += `<p>خطأ في تحويل النص إلى كلام: ${error.message}</p>`;
  }
}

function visualize() {
  if (!analyser) return;

  function draw() {
    requestAnimationFrame(draw);
    analyser.getByteFrequencyData(dataArray);
    
    const average = dataArray.reduce((a, b) => a + b) / dataArray.length;
    const scale = 1 + (average / 256) * 0.2; // Scale factor between 1 and 1.2
    circle.style.transform = `scale(${scale}) rotate(${Date.now() / 50}deg)`;
    
    // Update waveform
    for (let i = 0; i < bars.length; i++) {
      const barHeight = dataArray[i] / 2;
      bars[i].style.height = barHeight + 'px';
    }
  }

  draw();
}

let recognition;

function initSpeechRecognition() {
  if ('webkitSpeechRecognition' in window) {
    recognition = new webkitSpeechRecognition();
    recognition.continuous = false;
    recognition.lang = 'ar-SA'; // Set language to Arabic
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.onresult = async function(event) {
      const speechResult = event.results[0][0].transcript;
      outputDiv.innerHTML = `<p>قلت: ${speechResult}</p>`;
      try {
        const geminiResponse = await getGeminiResponse(speechResult);
        outputDiv.innerHTML += `<p>رد الذكاء الاصطناعي: ${geminiResponse}</p>`;
        await textToSpeech(geminiResponse);
      } catch (error) {
        console.error('خطأ:', error);
        outputDiv.innerHTML += `<p>خطأ: ${error.message}</p>`;
      }
    };

    recognition.onerror = function(event) {
      console.error('خطأ في التعرف على الكلام:', event.error);
      outputDiv.innerHTML += `<p>خطأ في التعرف على الكلام: ${event.error}</p>`;
    };
  } else {
    console.error('واجهة برمجة تطبيقات الكلام على الويب غير مدعومة في هذا المتصفح');
    outputDiv.innerHTML = '<p>واجهة برمجة تطبيقات الكلام على الويب غير مدعومة في هذا المتصفح</p>';
  }
}

function startListening() {
  if (recognition) {
    recognition.start();
    outputDiv.innerHTML = '<p>جارٍ الاستماع... تحدث الآن.</p>';
  } else {
    outputDiv.innerHTML = '<p>لم يتم تهيئة التعرف على الكلام.</p>';
  }
}

startButton.addEventListener('click', startListening);

// Initialize speech recognition
initSpeechRecognition();

// Handle iOS audio context activation
document.body.addEventListener('touchstart', function() {
  if (audioContext && audioContext.state !== 'running') {
    audioContext.resume();
  }
});
</script>
</body></html>